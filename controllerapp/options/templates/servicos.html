{% extends 'layout.html' %}
{% load static %}

{% block title %}Serviços do Laboratório{% endblock %}

{% block content %}
<!-- Hero -->
<section class="pg-hero">
  <div class="container">
    <div class="row align-items-center">
      <div class="col-lg-7">
        <span class="fl-tag">CAPACIDADES</span>
        <h1 class="pg-hero-title">Serviços do <span>FabLab</span></h1>
        <p class="pg-hero-sub">Conheça as tecnologias e serviços disponíveis em nosso laboratório para transformar suas ideias em realidade.</p>
        <a href="#categorias" class="fl-btn fl-btn-white mt-3">Explorar Serviços</a>
      </div>
    </div>
  </div>
</section>

<!-- Destaques -->
{% if servicos_destaque %}
<section class="fl-section">
  <div class="container">
    <div class="text-center mb-5">
      <span class="fl-tag">DESTAQUE</span>
      <h2 class="fl-heading">Serviços em <span>Destaque</span></h2>
    </div>
    <div class="row g-4">
      {% for servico in servicos_destaque %}
      <div class="col-md-4">
        <div class="pg-card-service pg-card-featured">
          <div class="pg-card-service-img">
            {% if servico.imagem %}
              <img src="{{ servico.imagem.url }}" alt="{{ servico.nome }}">
            {% else %}
              <img src="{% static 'images/default-service.jpg' %}" alt="{{ servico.nome }}">
            {% endif %}
            <span class="pg-badge-featured"><i class="fas fa-star me-1"></i> Destaque</span>
          </div>
          <div class="pg-card-service-body">
            <span class="pg-card-category">{{ servico.categoria.nome }}</span>
            <h5>{{ servico.nome }}</h5>
            <p>{{ servico.descricao_curta }}</p>
            <a href="{% url 'options:detalhe_servico' servico.id %}" class="fl-link">Ver detalhes <i class="fas fa-arrow-right ms-1"></i></a>
          </div>
        </div>
      </div>
      {% endfor %}
    </div>
  </div>
</section>
{% endif %}

<!-- Categorias -->
<section class="fl-section fl-section-alt" id="categorias">
  <div class="container">
    <div class="text-center mb-5">
      <span class="fl-tag">CATEGORIAS</span>
      <h2 class="fl-heading">Navegue por <span>Categoria</span></h2>
    </div>
    <div class="d-flex flex-wrap gap-2 justify-content-center mb-5">
      <a href="{% url 'options:servicos' %}" class="pg-filter-btn {% if not categoria_selecionada %}active{% endif %}">Todos</a>
      {% for categoria in categorias %}
        <a href="{% url 'options:servicos' %}?categoria={{ categoria.id }}" class="pg-filter-btn {% if categoria_selecionada == categoria.id|stringformat:'s' %}active{% endif %}">
          <i class="fas {{ categoria.icone }} me-1"></i> {{ categoria.nome }}
        </a>
      {% endfor %}
    </div>

    <!-- Lista -->
    <div class="row g-4">
      {% if servicos %}
        {% for servico in servicos %}
        <div class="col-md-6 col-lg-4">
          <div class="pg-card-service">
            <div class="pg-card-service-img">
              {% if servico.imagem %}
                <img src="{{ servico.imagem.url }}" alt="{{ servico.nome }}">
              {% else %}
                <img src="{% static 'images/default-service.jpg' %}" alt="{{ servico.nome }}">
              {% endif %}
              <span class="pg-card-cat-badge">{{ servico.categoria.nome }}</span>
            </div>
            <div class="pg-card-service-body">
              <h5>{{ servico.nome }}</h5>
              <p>{{ servico.descricao_curta }}</p>
              {% if servico.tempo_estimado %}
                <div class="pg-card-meta"><i class="far fa-clock me-1"></i> {{ servico.tempo_estimado }}</div>
              {% endif %}
              <a href="{% url 'options:detalhe_servico' servico.id %}" class="pg-btn-details mt-2" style="display:inline-block;width:auto;padding:.5rem 1.2rem">Ver detalhes</a>
            </div>
          </div>
        </div>
        {% endfor %}
      {% else %}
        <div class="col-12">
          <div class="pg-empty-state"><i class="fas fa-cogs"></i><h4>Nenhum serviço encontrado</h4><p>Não há serviços disponíveis para esta categoria no momento.</p></div>
        </div>
      {% endif %}
    </div>

    <!-- Paginação -->
    {% if servicos.paginator.num_pages > 1 %}
    <nav class="mt-5">
      <ul class="pg-pagination">
        {% if servicos.has_previous %}
          <li><a href="?{% if categoria_selecionada %}categoria={{ categoria_selecionada }}&{% endif %}page=1">&laquo;</a></li>
          <li><a href="?{% if categoria_selecionada %}categoria={{ categoria_selecionada }}&{% endif %}page={{ servicos.previous_page_number }}">Anterior</a></li>
        {% endif %}
        {% for num in servicos.paginator.page_range %}
          {% if servicos.number == num %}
            <li class="active"><span>{{ num }}</span></li>
          {% elif num > servicos.number|add:'-3' and num < servicos.number|add:'3' %}
            <li><a href="?{% if categoria_selecionada %}categoria={{ categoria_selecionada }}&{% endif %}page={{ num }}">{{ num }}</a></li>
          {% endif %}
        {% endfor %}
        {% if servicos.has_next %}
          <li><a href="?{% if categoria_selecionada %}categoria={{ categoria_selecionada }}&{% endif %}page={{ servicos.next_page_number }}">Próxima</a></li>
          <li><a href="?{% if categoria_selecionada %}categoria={{ categoria_selecionada }}&{% endif %}page={{ servicos.paginator.num_pages }}">&raquo;</a></li>
        {% endif %}
      </ul>
    </nav>
    {% endif %}
  </div>
</section>

<!-- Como funciona -->
<section class="fl-section">
  <div class="container">
    <div class="text-center mb-5">
      <span class="fl-tag">PROCESSO</span>
      <h2 class="fl-heading">Como utilizar o <span>Laboratório</span></h2>
      <p class="fl-subheading">Um processo simples e colaborativo para transformar suas ideias em projetos reais</p>
    </div>
    <div class="row g-4">
      <div class="col-md-6 col-lg-3">
        <div class="pg-step-card">
          <div class="pg-step-num">1</div>
          <div class="pg-step-icon"><i class="fas fa-lightbulb"></i></div>
          <h5>Tenha sua Ideia</h5>
          <p>Qualquer projeto inovador é bem-vindo! Desde protótipos simples até soluções complexas.</p>
        </div>
      </div>
      <div class="col-md-6 col-lg-3">
        <div class="pg-step-card">
          <div class="pg-step-num">2</div>
          <div class="pg-step-icon"><i class="fas fa-comments"></i></div>
          <h5>Entre em Contato</h5>
          <p>Apresente sua ideia para nossa equipe. Estamos aqui para ajudar!</p>
        </div>
      </div>
      <div class="col-md-6 col-lg-3">
        <div class="pg-step-card">
          <div class="pg-step-num">3</div>
          <div class="pg-step-icon"><i class="fas fa-users"></i></div>
          <h5>Trabalhe com Monitores</h5>
          <p>Nossos monitores orientam e apoiam durante todo o desenvolvimento.</p>
        </div>
      </div>
      <div class="col-md-6 col-lg-3">
        <div class="pg-step-card">
          <div class="pg-step-num">4</div>
          <div class="pg-step-icon"><i class="fas fa-rocket"></i></div>
          <h5>Realize seu Projeto</h5>
          <p>Com acesso gratuito aos equipamentos e suporte, transforme sua ideia em realidade!</p>
        </div>
      </div>
    </div>
  </div>
</section>

<!-- FAQ -->
<section class="fl-section fl-section-alt">
  <div class="container">
    <div class="text-center mb-5">
      <span class="fl-tag">FAQ</span>
      <h2 class="fl-heading">Perguntas <span>Frequentes</span></h2>
      <p class="fl-subheading">Tire suas dúvidas sobre o funcionamento do nosso laboratório</p>
    </div>
    <div class="row justify-content-center">
      <div class="col-lg-10">
        <div class="pg-accordion">
          <div class="pg-accordion-item open">
            <button class="pg-accordion-btn" onclick="toggleAccordion(this)">
              <div class="pg-acc-left">
                <span class="pg-acc-num">01</span>
                <span class="pg-acc-icon"><i class="fas fa-user-friends"></i></span>
                <span class="pg-acc-text">Quem pode utilizar o laboratório?</span>
              </div>
              <span class="pg-acc-toggle"><i class="fas fa-plus"></i><i class="fas fa-minus"></i></span>
            </button>
            <div class="pg-accordion-collapse">
              <div class="pg-accordion-body">
                <p>O FabLab está disponível principalmente para <strong>estudantes, professores e pesquisadores</strong> do IFMT. Visitantes externos podem acessar mediante agendamento prévio e aprovação da coordenação.</p>
              </div>
            </div>
          </div>
          <div class="pg-accordion-item">
            <button class="pg-accordion-btn" onclick="toggleAccordion(this)">
              <div class="pg-acc-left">
                <span class="pg-acc-num">02</span>
                <span class="pg-acc-icon"><i class="fas fa-coins"></i></span>
                <span class="pg-acc-text">O uso do laboratório é gratuito?</span>
              </div>
              <span class="pg-acc-toggle"><i class="fas fa-plus"></i><i class="fas fa-minus"></i></span>
            </button>
            <div class="pg-accordion-collapse">
              <div class="pg-accordion-body">
                <div class="pg-acc-highlight"><i class="fas fa-check-circle me-2"></i> <strong>Sim, o uso é totalmente gratuito!</strong></div>
                <p>Apenas em casos específicos de materiais especiais, o usuário pode precisar fornecê-los.</p>
              </div>
            </div>
          </div>
          <div class="pg-accordion-item">
            <button class="pg-accordion-btn" onclick="toggleAccordion(this)">
              <div class="pg-acc-left">
                <span class="pg-acc-num">03</span>
                <span class="pg-acc-icon"><i class="fas fa-calendar-alt"></i></span>
                <span class="pg-acc-text">Como agendar o uso de um equipamento?</span>
              </div>
              <span class="pg-acc-toggle"><i class="fas fa-plus"></i><i class="fas fa-minus"></i></span>
            </button>
            <div class="pg-accordion-collapse">
              <div class="pg-accordion-body">
                <ol class="pg-acc-steps">
                  <li>Faça login no sistema</li>
                  <li>Acesse a seção <strong>"Agendamentos"</strong></li>
                  <li>Selecione o equipamento desejado</li>
                  <li>Escolha data e horário disponíveis</li>
                  <li>Aguarde a confirmação por e-mail</li>
                </ol>
              </div>
            </div>
          </div>
          <div class="pg-accordion-item">
            <button class="pg-accordion-btn" onclick="toggleAccordion(this)">
              <div class="pg-acc-left">
                <span class="pg-acc-num">04</span>
                <span class="pg-acc-icon"><i class="fas fa-graduation-cap"></i></span>
                <span class="pg-acc-text">É necessário treinamento?</span>
              </div>
              <span class="pg-acc-toggle"><i class="fas fa-plus"></i><i class="fas fa-minus"></i></span>
            </button>
            <div class="pg-accordion-collapse">
              <div class="pg-accordion-body">
                <p>Sim, treinamentos são <strong>gratuitos</strong>, específicos para cada equipamento e incluem certificação.</p>
                <a href="{% url 'logs:agenda_home' %}" class="pg-acc-link"><i class="fas fa-calendar me-1"></i> Ver calendário de treinamentos</a>
              </div>
            </div>
          </div>
          <div class="pg-accordion-item">
            <button class="pg-accordion-btn" onclick="toggleAccordion(this)">
              <div class="pg-acc-left">
                <span class="pg-acc-num">05</span>
                <span class="pg-acc-icon"><i class="fas fa-clock"></i></span>
                <span class="pg-acc-text">Qual o horário de funcionamento?</span>
              </div>
              <span class="pg-acc-toggle"><i class="fas fa-plus"></i><i class="fas fa-minus"></i></span>
            </button>
            <div class="pg-accordion-collapse">
              <div class="pg-accordion-body">
                <div class="pg-acc-schedule">
                  <div class="pg-acc-schedule-row"><span>Segunda a Sexta</span><strong>8h — 18h</strong></div>
                  <div class="pg-acc-schedule-row muted"><span>Sábado e Domingo</span><span>Fechado</span></div>
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="text-center mt-5">
          <p class="text-muted">Ainda tem dúvidas?</p>
          <a href="https://www.instagram.com/ifmtmaker/" target="_blank" class="fl-btn"><i class="fab fa-instagram me-1"></i> Fale conosco</a>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block scripts %}
<script>
function toggleAccordion(btn) {
  var item = btn.closest('.pg-accordion-item');
  var wasOpen = item.classList.contains('open');
  document.querySelectorAll('.pg-accordion-item').forEach(function(el) { el.classList.remove('open'); });
  if (!wasOpen) { item.classList.add('open'); }
}
document.querySelectorAll('a[href^="#"]').forEach(function(a) {
  a.addEventListener('click', function(e) {
    e.preventDefault();
    var t = document.querySelector(this.getAttribute('href'));
    if (t) window.scrollTo({ top: t.offsetTop - 100, behavior: 'smooth' });
  });
});
</script>
{% endblock %}

{% block head %}
<style>
  /* ===== SHARED BASE ===== */
  .pg-hero { background:linear-gradient(135deg,var(--primary) 0%,var(--primary-light) 100%); padding:4rem 0 3rem; position:relative; overflow:hidden; }
  .pg-hero::before { content:''; position:absolute; inset:0; background:radial-gradient(circle at 80% 40%,rgba(69,196,176,.12) 0%,transparent 60%); }
  .pg-hero-title { font-size:2.5rem; font-weight:800; color:#fff; letter-spacing:-.02em; margin-bottom:.5rem; }
  .pg-hero-title span { color:var(--accent-light); }
  .pg-hero-sub { color:rgba(255,255,255,.8); font-size:1.05rem; max-width:560px; }
  .fl-tag { display:inline-block; background:linear-gradient(135deg,var(--accent),var(--accent-light)); color:#fff; font-size:.7rem; font-weight:700; letter-spacing:.12em; padding:.35rem 1rem; border-radius:999px; margin-bottom:.75rem; text-transform:uppercase; }
  .fl-heading { font-size:2.2rem; font-weight:800; color:var(--primary); letter-spacing:-.02em; margin-bottom:.6rem; }
  .fl-heading span { color:var(--accent); }
  .fl-subheading { color:var(--text-muted); font-size:1.05rem; max-width:600px; margin:0 auto; }
  .fl-section { padding:5rem 0; }
  .fl-section-alt { background:var(--surface-alt); }
  .fl-btn { display:inline-block; padding:.7rem 1.8rem; font-weight:600; font-size:.9rem; border-radius:var(--radius-sm); text-decoration:none; transition:all var(--transition); background:var(--accent); color:#fff; border:2px solid var(--accent); }
  .fl-btn:hover { background:var(--primary); border-color:var(--primary); color:#fff; transform:translateY(-2px); box-shadow:var(--shadow-md); }
  .fl-btn-white { background:#fff; color:var(--primary); border-color:#fff; }
  .fl-btn-white:hover { background:var(--surface-alt); color:var(--primary); border-color:var(--surface-alt); }
  .fl-link { color:var(--accent); text-decoration:none; font-weight:600; font-size:.875rem; transition:color var(--transition); }
  .fl-link:hover { color:var(--primary); }

  .pg-filter-btn { padding:.5rem 1.2rem; border:1px solid var(--border); border-radius:999px; background:var(--white); color:var(--text); font-size:.85rem; font-weight:600; cursor:pointer; text-decoration:none; transition:all var(--transition); display:inline-block; }
  .pg-filter-btn:hover { border-color:var(--accent); color:var(--accent); }
  .pg-filter-btn.active { background:var(--accent); color:#fff; border-color:var(--accent); }

  /* Service card */
  .pg-card-service { background:var(--white); border:1px solid var(--border); border-radius:var(--radius); overflow:hidden; height:100%; transition:all var(--transition); }
  .pg-card-service:hover { transform:translateY(-6px); box-shadow:var(--shadow-lg); border-color:transparent; }
  .pg-card-service-img { position:relative; height:200px; overflow:hidden; }
  .pg-card-service-img img { width:100%; height:100%; object-fit:cover; transition:transform .5s; }
  .pg-card-service:hover .pg-card-service-img img { transform:scale(1.06); }
  .pg-card-cat-badge { position:absolute; top:.75rem; right:.75rem; background:rgba(11,37,69,.75); color:#fff; padding:.3rem .7rem; border-radius:999px; font-size:.75rem; font-weight:600; }
  .pg-badge-featured { position:absolute; top:.75rem; left:.75rem; background:#F59E0B; color:#fff; padding:.3rem .7rem; border-radius:999px; font-size:.75rem; font-weight:600; }
  .pg-card-service-body { padding:1.25rem; display:flex; flex-direction:column; }
  .pg-card-service-body h5 { font-size:1.05rem; font-weight:700; color:var(--primary); margin-bottom:.4rem; }
  .pg-card-service-body p { font-size:.85rem; color:var(--text-muted); line-height:1.6; flex:1; }
  .pg-card-category { font-size:.75rem; font-weight:600; color:var(--accent); margin-bottom:.3rem; text-transform:uppercase; letter-spacing:.05em; }
  .pg-card-meta { font-size:.8rem; color:var(--text-muted); margin-bottom:.5rem; }
  .pg-btn-details { padding:.6rem 1rem; border:2px solid var(--accent); background:transparent; color:var(--accent); border-radius:var(--radius-sm); font-weight:600; font-size:.85rem; cursor:pointer; text-decoration:none; transition:all var(--transition); text-align:center; }
  .pg-btn-details:hover { background:var(--accent); color:#fff; }

  /* Steps */
  .pg-step-card { background:var(--white); border:1px solid var(--border); border-radius:var(--radius); padding:2rem 1.5rem; text-align:center; height:100%; position:relative; transition:all var(--transition); }
  .pg-step-card:hover { transform:translateY(-6px); box-shadow:var(--shadow-lg); border-color:transparent; }
  .pg-step-num { position:absolute; top:-.8rem; left:50%; transform:translateX(-50%); width:28px; height:28px; border-radius:50%; background:var(--accent); color:#fff; font-size:.75rem; font-weight:800; display:flex; align-items:center; justify-content:center; }
  .pg-step-icon { width:56px; height:56px; border-radius:50%; background:linear-gradient(135deg,rgba(19,103,138,.08),rgba(69,196,176,.12)); color:var(--accent); display:flex; align-items:center; justify-content:center; font-size:1.4rem; margin:0 auto 1rem; transition:all .4s; }
  .pg-step-card:hover .pg-step-icon { background:var(--accent); color:#fff; }
  .pg-step-card h5 { font-size:1rem; font-weight:700; color:var(--primary); margin-bottom:.4rem; }
  .pg-step-card p { font-size:.85rem; color:var(--text-muted); line-height:1.6; margin:0; }

  /* Accordion — Premium */
  .pg-accordion { display:flex; flex-direction:column; gap:.75rem; }
  .pg-accordion-item { background:var(--white); border:1px solid var(--border); border-radius:var(--radius); overflow:hidden; transition:all .35s cubic-bezier(.4,0,.2,1); position:relative; }
  .pg-accordion-item::before { content:''; position:absolute; left:0; top:0; bottom:0; width:4px; background:var(--accent); border-radius:var(--radius) 0 0 var(--radius); transform:scaleY(0); transition:transform .3s ease; }
  .pg-accordion-item:hover { box-shadow:0 4px 20px rgba(11,37,69,.06); border-color:rgba(19,103,138,.2); }
  .pg-accordion-item.open { border-color:rgba(19,103,138,.25); box-shadow:0 8px 30px rgba(11,37,69,.08); }
  .pg-accordion-item.open::before { transform:scaleY(1); }
  .pg-accordion-btn { width:100%; display:flex; justify-content:space-between; align-items:center; padding:1.15rem 1.5rem; border:none; background:transparent; cursor:pointer; text-align:left; transition:all var(--transition); gap:1rem; }
  .pg-acc-left { display:flex; align-items:center; gap:.85rem; min-width:0; }
  .pg-acc-num { font-size:.7rem; font-weight:800; color:var(--accent); opacity:.5; letter-spacing:.05em; flex-shrink:0; transition:opacity .3s; }
  .pg-accordion-item.open .pg-acc-num { opacity:1; }
  .pg-acc-icon { width:38px; height:38px; border-radius:10px; background:linear-gradient(135deg,rgba(19,103,138,.06),rgba(69,196,176,.08)); color:var(--accent); display:flex; align-items:center; justify-content:center; font-size:.9rem; flex-shrink:0; transition:all .35s; }
  .pg-accordion-item.open .pg-acc-icon { background:linear-gradient(135deg,var(--accent),var(--accent-light)); color:#fff; box-shadow:0 4px 12px rgba(19,103,138,.25); }
  .pg-acc-text { font-size:.95rem; font-weight:600; color:var(--primary); }
  .pg-acc-toggle { width:30px; height:30px; border-radius:50%; background:var(--surface-alt); display:flex; align-items:center; justify-content:center; flex-shrink:0; transition:all .35s; }
  .pg-acc-toggle i { position:absolute; font-size:.7rem; color:var(--text-muted); transition:all .3s; }
  .pg-acc-toggle .fa-plus { opacity:1; transform:rotate(0deg); }
  .pg-acc-toggle .fa-minus { opacity:0; transform:rotate(-90deg); }
  .pg-accordion-item.open .pg-acc-toggle { background:var(--accent); }
  .pg-accordion-item.open .pg-acc-toggle .fa-plus { opacity:0; transform:rotate(90deg); }
  .pg-accordion-item.open .pg-acc-toggle .fa-minus { opacity:1; transform:rotate(0deg); color:#fff; }
  .pg-accordion-collapse { max-height:0; overflow:hidden; transition:max-height .4s cubic-bezier(.4,0,.2,1); }
  .pg-accordion-item.open .pg-accordion-collapse { max-height:400px; }
  .pg-accordion-body { padding:.25rem 1.5rem 1.25rem 5.35rem; font-size:.9rem; color:var(--text-muted); line-height:1.75; }
  .pg-accordion-body p { margin-bottom:.5rem; }
  .pg-accordion-body a { color:var(--accent); font-weight:600; }
  .pg-acc-highlight { background:linear-gradient(135deg,rgba(69,196,176,.08),rgba(19,103,138,.06)); padding:.65rem 1rem; border-radius:var(--radius-sm); margin-bottom:.65rem; color:var(--accent); font-size:.88rem; }
  .pg-acc-steps { padding-left:1.25rem; margin:0; }
  .pg-acc-steps li { margin-bottom:.4rem; font-size:.88rem; }
  .pg-acc-steps li::marker { color:var(--accent); font-weight:700; }
  .pg-acc-link { display:inline-flex; align-items:center; gap:.3rem; padding:.5rem 1rem; background:rgba(19,103,138,.06); border-radius:var(--radius-sm); color:var(--accent); text-decoration:none; font-size:.85rem; font-weight:600; margin-top:.5rem; transition:all var(--transition); }
  .pg-acc-link:hover { background:var(--accent); color:#fff; }
  .pg-acc-schedule { display:flex; flex-direction:column; gap:.4rem; }
  .pg-acc-schedule-row { display:flex; justify-content:space-between; padding:.5rem .85rem; background:var(--surface-alt); border-radius:var(--radius-sm); font-size:.88rem; }
  .pg-acc-schedule-row.muted { opacity:.6; }
  @media(max-width:768px) { .pg-accordion-body { padding-left:1.5rem; } .pg-acc-num { display:none; } }

  /* Pagination */
  .pg-pagination { display:flex; justify-content:center; gap:.3rem; list-style:none; padding:0; }
  .pg-pagination li a, .pg-pagination li span { display:inline-block; padding:.5rem .85rem; border-radius:var(--radius-sm); font-size:.85rem; font-weight:600; text-decoration:none; transition:all var(--transition); border:1px solid var(--border); color:var(--text); background:var(--white); }
  .pg-pagination li a:hover { border-color:var(--accent); color:var(--accent); }
  .pg-pagination li.active span { background:var(--accent); color:#fff; border-color:var(--accent); }

  .pg-empty-state { text-align:center; padding:3rem; }
  .pg-empty-state i { font-size:3rem; color:var(--border); margin-bottom:1rem; display:block; }
  .pg-empty-state h4 { color:var(--text); font-weight:700; }
  .pg-empty-state p { color:var(--text-muted); }

  @media (max-width:768px) {
    .pg-hero-title { font-size:1.8rem; }
    .pg-hero { padding:3rem 0 2rem; }
  }
</style>
{% endblock %}