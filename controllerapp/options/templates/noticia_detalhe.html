{% extends 'layout.html' %}
{% load static %}

{% block title %}{{ noticia.titulo }} - FabLab IFMT{% endblock %}

{% block content %}
<!-- Breadcrumb -->
<section style="background:var(--surface-alt);padding:1rem 0;border-bottom:1px solid var(--border)">
  <div class="container">
    <nav style="font-size:.85rem">
      <a href="{% url 'options:noticias' %}" class="fl-link"><i class="fas fa-arrow-left me-1"></i> Todas as notícias</a>
    </nav>
  </div>
</section>

<!-- Article -->
<section class="fl-section">
  <div class="container">
    <div class="row g-5">
      <!-- Main -->
      <div class="col-lg-8">
        <article class="pg-article">
          <!-- Image -->
          <div class="pg-article-img mb-4">
            <img src="{{ noticia.imagem.url }}" alt="{{ noticia.titulo }}">
            {% if noticia.destaque %}<span class="pg-featured-badge"><i class="fas fa-star me-1"></i> Destaque</span>{% endif %}
          </div>

          <!-- Meta -->
          <div class="pg-article-meta mb-3">
            <span><i class="far fa-calendar-alt me-1"></i> {{ noticia.data_publicacao|date:"d/m/Y \à\s H:i" }}</span>
            {% if noticia.autor %}<span><i class="far fa-user me-1"></i> {{ noticia.autor.get_full_name|default:noticia.autor.username }}</span>{% endif %}
          </div>

          <h1 class="pg-article-title">{{ noticia.titulo }}</h1>

          <!-- Tags -->
          {% if noticia.hashtags.all %}
          <div class="pg-tags-row mb-4">
            {% for tag in noticia.hashtags.all %}
              <a href="{% url 'options:noticias_por_tag' tag.slug %}">#{{ tag.nome }}</a>
            {% endfor %}
          </div>
          {% endif %}

          <!-- Content -->
          <div class="pg-article-body">
            {{ noticia.conteudo|safe }}
          </div>

          <!-- Share -->
          <div class="pg-share mt-5 pt-4">
            <h6><i class="fas fa-share-alt me-2"></i>Compartilhar</h6>
            <div class="pg-share-btns">
              <a href="https://www.facebook.com/sharer/sharer.php?u={{ request.build_absolute_uri }}" target="_blank" rel="noopener" class="pg-share-btn" style="--sc:#1877F2"><i class="fab fa-facebook-f"></i></a>
              <a href="https://twitter.com/intent/tweet?url={{ request.build_absolute_uri }}&text={{ noticia.titulo }}" target="_blank" rel="noopener" class="pg-share-btn" style="--sc:#1DA1F2"><i class="fab fa-twitter"></i></a>
              <a href="https://api.whatsapp.com/send?text={{ noticia.titulo }}%20-%20{{ request.build_absolute_uri }}" target="_blank" rel="noopener" class="pg-share-btn" style="--sc:#25D366"><i class="fab fa-whatsapp"></i></a>
              <a href="https://www.linkedin.com/sharing/share-offsite/?url={{ request.build_absolute_uri }}" target="_blank" rel="noopener" class="pg-share-btn" style="--sc:#0A66C2"><i class="fab fa-linkedin-in"></i></a>
            </div>
          </div>
        </article>
      </div>

      <!-- Sidebar -->
      <div class="col-lg-4">
        <div class="sticky-lg-top" style="top:100px">
          <!-- Related -->
          <div class="pg-sidebar-card mb-4">
            <h5><i class="fas fa-newspaper me-2"></i> Relacionadas</h5>
            {% for rel in noticias_relacionadas %}
            <a href="{{ rel.get_absolute_url }}" class="pg-related-item">
              <div class="pg-related-img"><img src="{{ rel.imagem.url }}" alt="{{ rel.titulo }}"></div>
              <div class="pg-related-info">
                <span class="pg-related-title">{{ rel.titulo|truncatechars:55 }}</span>
                <small>{{ rel.data_publicacao|date:"d/m/Y" }}</small>
              </div>
            </a>
            {% empty %}
            <p class="text-muted" style="font-size:.85rem">Sem notícias relacionadas no momento.</p>
            {% endfor %}
          </div>

          <!-- Topics -->
          {% if hashtags %}
          <div class="pg-sidebar-card mb-4">
            <h5><i class="fas fa-hashtag me-2"></i> Tópicos</h5>
            <div class="pg-tags-row">
              {% for tag in hashtags %}
                <a href="{% url 'options:noticias_por_tag' tag.slug %}">#{{ tag.nome }}</a>
              {% endfor %}
            </div>
          </div>
          {% endif %}

          <!-- Quick Links -->
          <div class="pg-sidebar-card">
            <h5><i class="fas fa-link me-2"></i> Links Rápidos</h5>
            <div class="d-grid gap-2">
              <a href="{% url 'options:noticias' %}" class="pg-btn-details"><i class="fas fa-newspaper me-1"></i> Todas as Notícias</a>
              <a href="{% url 'home' %}" class="pg-btn-details"><i class="fas fa-home me-1"></i> Página Inicial</a>
              <a href="{% url 'about' %}" class="pg-btn-details"><i class="fas fa-info-circle me-1"></i> Sobre o FabLab</a>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</section>
{% endblock %}

{% block head %}
<style>
  .fl-section { padding:5rem 0; }
  .fl-link { color:var(--accent); text-decoration:none; font-weight:600; font-size:.875rem; transition:color var(--transition); }
  .fl-link:hover { color:var(--primary); }

  .pg-article-img { position:relative; border-radius:var(--radius); overflow:hidden; max-height:500px; }
  .pg-article-img img { width:100%; height:100%; object-fit:cover; }
  .pg-featured-badge { position:absolute; top:1rem; right:1rem; background:#F59E0B; color:#fff; padding:.4rem .9rem; border-radius:999px; font-size:.8rem; font-weight:600; }

  .pg-article-meta { display:flex; flex-wrap:wrap; gap:1.25rem; font-size:.85rem; color:var(--text-muted); }
  .pg-article-title { font-size:2.2rem; font-weight:800; color:var(--primary); line-height:1.3; margin-bottom:.75rem; }

  .pg-tags-row { display:flex; flex-wrap:wrap; gap:.35rem; }
  .pg-tags-row a { background:rgba(19,103,138,.08); color:var(--accent); padding:.25rem .65rem; border-radius:999px; font-size:.75rem; font-weight:600; text-decoration:none; transition:all var(--transition); }
  .pg-tags-row a:hover { background:var(--accent); color:#fff; }

  .pg-article-body { font-size:1.08rem; line-height:1.85; color:var(--text); }
  .pg-article-body p { margin-bottom:1.5rem; }
  .pg-article-body img { max-width:100%; height:auto; margin:1.5rem 0; border-radius:var(--radius-sm); }
  .pg-article-body h2,.pg-article-body h3,.pg-article-body h4 { margin-top:2rem; margin-bottom:1rem; color:var(--primary); font-weight:700; }
  .pg-article-body a { color:var(--accent); text-decoration:none; }
  .pg-article-body a:hover { text-decoration:underline; }
  .pg-article-body blockquote { border-left:4px solid var(--accent); padding:1rem 1.5rem; margin:1.5rem 0; background:var(--surface-alt); border-radius:0 var(--radius-sm) var(--radius-sm) 0; }

  .pg-share { border-top:1px solid var(--border); }
  .pg-share h6 { font-weight:700; color:var(--primary); margin-bottom:.75rem; }
  .pg-share-btns { display:flex; gap:.5rem; }
  .pg-share-btn { width:42px; height:42px; display:flex; align-items:center; justify-content:center; border-radius:50%; border:2px solid var(--border); color:var(--text-muted); text-decoration:none; font-size:1rem; transition:all var(--transition); }
  .pg-share-btn:hover { border-color:var(--sc); color:var(--sc); background:rgba(0,0,0,.02); }

  .pg-sidebar-card { background:var(--white); border:1px solid var(--border); border-radius:var(--radius); padding:1.25rem; }
  .pg-sidebar-card h5 { font-size:.95rem; font-weight:700; color:var(--primary); margin-bottom:1rem; }

  .pg-related-item { display:flex; gap:.75rem; padding:.65rem 0; border-bottom:1px solid var(--border); text-decoration:none; transition:all var(--transition); }
  .pg-related-item:last-child { border-bottom:none; padding-bottom:0; }
  .pg-related-item:hover .pg-related-title { color:var(--accent); }
  .pg-related-img { width:60px; height:45px; border-radius:var(--radius-sm); overflow:hidden; flex-shrink:0; }
  .pg-related-img img { width:100%; height:100%; object-fit:cover; }
  .pg-related-info { display:flex; flex-direction:column; }
  .pg-related-title { font-size:.82rem; font-weight:600; color:var(--primary); line-height:1.3; transition:color var(--transition); }
  .pg-related-info small { color:var(--text-muted); font-size:.75rem; }

  .pg-btn-details { padding:.6rem 1rem; border:2px solid var(--accent); background:transparent; color:var(--accent); border-radius:var(--radius-sm); font-weight:600; font-size:.85rem; cursor:pointer; text-decoration:none; text-align:center; transition:all var(--transition); display:block; }
  .pg-btn-details:hover { background:var(--accent); color:#fff; }

  @media(max-width:768px){ .pg-article-title{font-size:1.6rem;} }
</style>
{% endblock %}