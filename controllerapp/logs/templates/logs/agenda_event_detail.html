{% extends 'layout.html' %}
{% load static %}

{% block title %}{{ event.title }} — Detalhes do Evento{% endblock %}

{% block head %}
<style>
/* ── Detalhe do Evento ────────────────────────────── */
.ed-hero{padding:3rem 0 2.5rem;color:#fff;margin-bottom:2.5rem}
.ed-hero.type-internal{background:linear-gradient(135deg,#2563EB 0%,#3B82F6 100%)}
.ed-hero.type-workshop{background:linear-gradient(135deg,#059669 0%,#10B981 100%)}
.ed-hero.type-visit{background:linear-gradient(135deg,#DC2626 0%,#EF4444 100%)}
.ed-hero.type-maintenance{background:linear-gradient(135deg,#D97706 0%,#F59E0B 100%)}
.ed-hero.type-other{background:linear-gradient(135deg,var(--primary) 0%,var(--primary-light) 100%)}
.ed-hero h1{font-weight:700;font-size:1.75rem;margin:0 0 .5rem}
.ed-bc{display:flex;gap:.5rem;font-size:.85rem;opacity:.7;margin-bottom:.75rem}
.ed-bc a{color:#fff;text-decoration:none}
.ed-bc a:hover{text-decoration:underline}
.ed-badge{display:inline-flex;align-items:center;gap:.4rem;padding:.35rem .9rem;border-radius:20px;background:rgba(255,255,255,.2);font-size:.8rem;font-weight:600;backdrop-filter:blur(4px)}
.ed-meta{display:flex;flex-wrap:wrap;gap:1.25rem;margin-top:.75rem;font-size:.9rem;opacity:.9}
.ed-meta i{margin-right:.35rem}

.ed-grid{display:grid;grid-template-columns:1fr 340px;gap:1.75rem}
@media(max-width:992px){.ed-grid{grid-template-columns:1fr}}

.ed-card{background:var(--white);border-radius:var(--radius);box-shadow:0 4px 24px rgba(11,37,69,.07);overflow:hidden;margin-bottom:1.5rem}
.ed-card-head{background:var(--surface-alt);padding:1.1rem 1.5rem;border-bottom:1px solid var(--border);display:flex;align-items:center;gap:.65rem}
.ed-card-head i{color:var(--accent);font-size:1rem}
.ed-card-head h2{font-size:1rem;font-weight:600;margin:0;color:var(--text)}
.ed-card-body{padding:1.5rem}

.ed-desc{white-space:pre-line;color:var(--text);line-height:1.7;font-size:.925rem}
.ed-organizer{display:flex;align-items:center;gap:1rem}
.ed-avatar{width:48px;height:48px;border-radius:50%;background:linear-gradient(135deg,var(--accent),var(--accent-light));display:flex;align-items:center;justify-content:center;font-weight:700;color:#fff;font-size:1.1rem}

.ed-info-list{list-style:none;padding:0;margin:0}
.ed-info-list li{display:flex;align-items:flex-start;gap:.75rem;padding:.75rem 0;border-bottom:1px solid var(--border);font-size:.9rem}
.ed-info-list li:last-child{border-bottom:none}
.ed-info-list .ed-il-icon{width:32px;height:32px;border-radius:var(--radius-sm);background:var(--surface-alt);display:flex;align-items:center;justify-content:center;flex-shrink:0}
.ed-info-list .ed-il-icon i{color:var(--accent);font-size:.85rem}
.ed-info-list .ed-il-label{font-size:.75rem;color:var(--text-muted);text-transform:uppercase;letter-spacing:.03em}
.ed-info-list .ed-il-value{font-weight:600;color:var(--text)}

.ed-admin-actions{display:flex;flex-direction:column;gap:.5rem}
.ed-admin-actions .fl-btn{display:inline-flex;align-items:center;justify-content:center;gap:.5rem;padding:.6rem 1rem;border-radius:var(--radius-sm);font-weight:600;font-size:.85rem;border:none;cursor:pointer;transition:all var(--transition);text-decoration:none;width:100%}
.ed-admin-actions .fl-btn-approve{background:#059669;color:#fff}
.ed-admin-actions .fl-btn-approve:hover{background:#10B981}
.ed-admin-actions .fl-btn-danger{background:#EF4444;color:#fff}
.ed-admin-actions .fl-btn-danger:hover{background:#DC2626}
.ed-admin-actions .fl-btn-outline{background:transparent;border:1.5px solid var(--border);color:var(--text-muted)}
.ed-admin-actions .fl-btn-outline:hover{border-color:var(--accent);color:var(--accent)}
</style>
{% endblock %}

{% block content %}
<!-- Hero -->
<section class="ed-hero type-{{ event.event_type }}">
  <div class="container">
    <div class="ed-bc"><a href="{% url 'logs:agenda_home' %}">Agenda</a> <span>/</span> <span>Evento</span></div>
    <span class="ed-badge"><i class="fas fa-tag"></i> {{ event.get_event_type_display }}</span>
    <h1>{{ event.title }}</h1>
    <div class="ed-meta">
      <span><i class="fas fa-calendar-alt"></i>{{ event.start_time|date:"d/m/Y" }}</span>
      <span><i class="fas fa-clock"></i>{{ event.start_time|date:"H:i" }} — {{ event.end_time|date:"H:i" }}</span>
      {% if not event.approved %}<span><i class="fas fa-hourglass-half"></i>Pendente de aprovação</span>{% endif %}
    </div>
  </div>
</section>

<div class="container" style="margin-bottom:3rem">
  <div class="ed-grid">
    <!-- Coluna principal -->
    <div>
      <!-- Descrição -->
      <div class="ed-card">
        <div class="ed-card-head"><i class="fas fa-align-left"></i><h2>Sobre este evento</h2></div>
        <div class="ed-card-body">
          {% if event.description %}
            <div class="ed-desc">{{ event.description|linebreaks }}</div>
          {% else %}
            <p style="color:var(--text-muted);font-style:italic">Nenhuma descrição fornecida.</p>
          {% endif %}
        </div>
      </div>

      <!-- Organizador -->
      {% if event.created_by %}
      <div class="ed-card">
        <div class="ed-card-head"><i class="fas fa-user-circle"></i><h2>Organizador</h2></div>
        <div class="ed-card-body">
          <div class="ed-organizer">
            <div class="ed-avatar">{{ event.created_by.first_name|first }}{{ event.created_by.last_name|first }}</div>
            <div>
              <div style="font-weight:600;color:var(--text)">{{ event.created_by.first_name }} {{ event.created_by.last_name }}</div>
              <div style="font-size:.85rem;color:var(--text-muted)">{{ event.created_by.email }}</div>
            </div>
          </div>
        </div>
      </div>
      {% endif %}
    </div>

    <!-- Sidebar -->
    <div>
      <!-- Informações -->
      <div class="ed-card">
        <div class="ed-card-head"><i class="fas fa-info-circle"></i><h2>Informações</h2></div>
        <div class="ed-card-body" style="padding:0 1.5rem">
          <ul class="ed-info-list">
            <li>
              <div class="ed-il-icon"><i class="fas fa-calendar-day"></i></div>
              <div><div class="ed-il-label">Data</div><div class="ed-il-value">{{ event.start_time|date:"d/m/Y" }}</div></div>
            </li>
            <li>
              <div class="ed-il-icon"><i class="fas fa-clock"></i></div>
              <div><div class="ed-il-label">Horário</div><div class="ed-il-value">{{ event.start_time|date:"H:i" }} — {{ event.end_time|date:"H:i" }}</div></div>
            </li>
            <li>
              <div class="ed-il-icon"><i class="fas fa-tag"></i></div>
              <div><div class="ed-il-label">Tipo</div><div class="ed-il-value">{{ event.get_event_type_display }}</div></div>
            </li>
            <li>
              <div class="ed-il-icon"><i class="fas fa-{% if event.approved %}check-circle{% else %}hourglass-half{% endif %}"></i></div>
              <div><div class="ed-il-label">Status</div><div class="ed-il-value">{% if event.approved %}Aprovado{% else %}Pendente{% endif %}</div></div>
            </li>
          </ul>
        </div>
      </div>

      <!-- Ações -->
      <div class="ed-card">
        <div class="ed-card-body">
          <div class="ed-admin-actions">
            <a href="{% url 'logs:agenda_home' %}" class="fl-btn fl-btn-outline"><i class="fas fa-arrow-left"></i> Voltar à Agenda</a>
            {% if user.is_staff %}
              {% if not event.approved %}
                <a href="{% url 'logs:agenda_approve_event' event.id %}" class="fl-btn fl-btn-approve"><i class="fas fa-check"></i> Aprovar Evento</a>
              {% endif %}
              <a href="{% url 'logs:agenda_delete_event' event.id %}" class="fl-btn fl-btn-danger"
                 onclick="return confirm('Tem certeza que deseja {% if event.approved %}excluir{% else %}rejeitar{% endif %} este evento?');">
                <i class="fas fa-trash-alt"></i> {% if event.approved %}Excluir{% else %}Rejeitar{% endif %} Evento
              </a>
            {% endif %}
          </div>
        </div>
      </div>
    </div>
  </div>
</div>
{% endblock %}
